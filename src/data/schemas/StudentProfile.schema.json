{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://smart-campus.edu/schemas/student-profile.json",
  "title": "Student Profile",
  "description": "Student identity, settings, and preferences for Smart Campus experience",
  "type": "object",
  "required": ["id", "email", "display_name", "settings"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique student identifier (UUID)",
      "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$"
    },
    "email": {
      "type": "string",
      "format": "email",
      "description": "Student email address"
    },
    "display_name": {
      "type": "string",
      "description": "Publicly visible display name",
      "minLength": 1,
      "maxLength": 50
    },
    "avatar_url": {
      "type": "string",
      "format": "uri",
      "description": "Profile picture URL"
    },
    "bio": {
      "type": "string",
      "description": "Short bio or tagline",
      "maxLength": 200
    },
    "settings": {
      "type": "object",
      "required": ["notifications", "privacy", "preferences"],
      "properties": {
        "notifications": {
          "$ref": "#/definitions/NotificationSettings"
        },
        "privacy": {
          "$ref": "#/definitions/PrivacySettings"
        },
        "preferences": {
          "$ref": "#/definitions/UserPreferences"
        }
      }
    },
    "interests": {
      "type": "object",
      "properties": {
        "topics": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Topics of interest for discovery and matching"
        },
        "favorite_rooms": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of favorite room IDs"
        },
        "study_groups": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": { "type": "string" },
              "name": { "type": "string" },
              "role": {
                "type": "string",
                "enum": ["member", "organizer", "admin"]
              }
            }
          }
        }
      }
    },
    "integrations": {
      "type": "object",
      "description": "Connected MCP integrations",
      "properties": {
        "notion": {
          "$ref": "#/definitions/IntegrationConfig"
        },
        "slack": {
          "$ref": "#/definitions/IntegrationConfig"
        },
        "figma": {
          "$ref": "#/definitions/IntegrationConfig"
        },
        "github": {
          "$ref": "#/definitions/IntegrationConfig"
        },
        "calendar": {
          "$ref": "#/definitions/IntegrationConfig"
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "created_at": { "type": "string", "format": "date-time" },
        "updated_at": { "type": "string", "format": "date-time" },
        "last_login": { "type": "string", "format": "date-time" },
        "onboarding_completed": { "type": "boolean", "default": false }
      }
    }
  },
  "definitions": {
    "NotificationSettings": {
      "type": "object",
      "properties": {
        "chat_messages": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": true },
            "sound": { "type": "boolean", "default": true },
            "desktop": { "type": "boolean", "default": true },
            "email": { "type": "boolean", "default": false }
          }
        },
        "room_events": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": true },
            "upcoming_reservations": { "type": "boolean", "default": true },
            "room_availability": { "type": "boolean", "default": true }
          }
        },
        "sensor_alerts": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "air_quality_warnings": { "type": "boolean", "default": true },
            "occupancy_threshold": { "type": "boolean", "default": false }
          }
        },
        "group_activity": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": true },
            "new_members": { "type": "boolean", "default": true },
            "study_session_invites": { "type": "boolean", "default": true }
          }
        },
        "do_not_disturb": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "schedule": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "days": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": ["monday", "tuesday", "wednesday", "thursday", "friday", "saturday", "sunday"]
                    }
                  },
                  "start_time": { "type": "string", "pattern": "^([01]?[0-9]|2[0-3]):[0-5][0-9]$" },
                  "end_time": { "type": "string", "pattern": "^([01]?[0-9]|2[0-3]):[0-5][0-9]$" }
                }
              }
            }
          }
        }
      }
    },
    "PrivacySettings": {
      "type": "object",
      "properties": {
        "presence_visibility": {
          "type": "string",
          "enum": ["visible", "invisible", "friends_only", "same_room_only"],
          "default": "visible",
          "description": "Who can see your presence in rooms"
        },
        "profile_visibility": {
          "type": "string",
          "enum": ["public", "campus_only", "private"],
          "default": "campus_only"
        },
        "activity_history": {
          "type": "object",
          "properties": {
            "share_room_visits": { "type": "boolean", "default": false },
            "share_chat_participation": { "type": "boolean", "default": true },
            "share_project_activity": { "type": "boolean", "default": true }
          }
        },
        "discovery": {
          "type": "object",
          "properties": {
            "allow_topic_matching": { "type": "boolean", "default": true },
            "allow_group_suggestions": { "type": "boolean", "default": true },
            "show_in_directory": { "type": "boolean", "default": true }
          }
        }
      }
    },
    "UserPreferences": {
      "type": "object",
      "properties": {
        "communication_mode": {
          "type": "string",
          "enum": ["text_only", "voice_preferred", "mixed", "async_preferred"],
          "default": "mixed",
          "description": "Preferred mode of interaction"
        },
        "learning_style": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["visual", "auditory", "kinesthetic", "reading_writing"]
          },
          "description": "Learning preferences for personalized content"
        },
        "theme": {
          "type": "object",
          "properties": {
            "mode": {
              "type": "string",
              "enum": ["light", "dark", "auto"],
              "default": "auto"
            },
            "accent_color": {
              "type": "string",
              "pattern": "^#[0-9A-Fa-f]{6}$"
            }
          }
        },
        "accessibility": {
          "type": "object",
          "properties": {
            "reduced_motion": { "type": "boolean", "default": false },
            "high_contrast": { "type": "boolean", "default": false },
            "text_size": {
              "type": "string",
              "enum": ["small", "medium", "large", "extra_large"],
              "default": "medium"
            },
            "screen_reader": { "type": "boolean", "default": false }
          }
        },
        "default_classroom_view": {
          "type": "string",
          "enum": ["default", "lecture", "lab", "lounge"],
          "default": "default"
        }
      }
    },
    "IntegrationConfig": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean", "default": false },
        "credentials": {
          "type": "object",
          "description": "OAuth tokens or API keys (encrypted)"
        },
        "settings": {
          "type": "object",
          "description": "Integration-specific settings"
        },
        "last_sync": { "type": "string", "format": "date-time" }
      }
    }
  }
}
